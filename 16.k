/ First cut (approx)

i:0\0:`16.txt
rules:0 1+/:/:`i$"-"\''@[;0 2]'-3#'rawrules:" "\'i[0]
myT:`i$","\*1_i[1]
nearbyT: `i$1_","\'i[2]

29759~+/(,/nearbyT)@&,/~bad:|/within\:/:[nearbyT; ,/rules]

valid:+nearbyT@&&/+bad
satisfied: {|/x within/: y}
names: *'rawrules
matches:(&&/+)'satisfied/:\:[valid;rules]
order:*+({y_x}':matches@<l)@-1+l:#'matches
1307550234719~*/myT@&"departure"~/:9#'names@order
